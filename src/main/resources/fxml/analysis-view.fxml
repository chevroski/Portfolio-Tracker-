<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.layout.Priority?>
<?import org.kordamp.ikonli.javafx.FontIcon?>

<VBox xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" 
      fx:controller="com.portfoliotracker.controller.AnalysisController"
      spacing="20" styleClass="analysis-view">
    <padding>
        <Insets top="25" right="30" bottom="25" left="30"/>
    </padding>
    
    <!-- Header -->
    <HBox alignment="CENTER_LEFT" spacing="15">
        <FontIcon iconLiteral="fas-search-dollar" iconSize="28" styleClass="header-icon"/>
        <Label text="Market Analysis" styleClass="page-title"/>
        <Pane HBox.hgrow="ALWAYS"/>
        <Button text="Refresh" onAction="#onRefresh" styleClass="btn-secondary">
            <graphic><FontIcon iconLiteral="fas-sync-alt" iconSize="12"/></graphic>
        </Button>
    </HBox>
    
    <!-- Whale Alerts Section -->
    <VBox styleClass="section-card" spacing="15">
        <HBox alignment="CENTER_LEFT" spacing="10">
            <FontIcon iconLiteral="fas-fish" iconSize="20" styleClass="section-icon"/>
            <Label text="Whale Alerts" styleClass="section-title"/>
            <Pane HBox.hgrow="ALWAYS"/>
            <Label text="Transactions &gt; \$1M" styleClass="filter-label"/>
        </HBox>
        
        <TableView fx:id="whaleTable" prefHeight="300" styleClass="whale-table">
            <columns>
                <TableColumn fx:id="timeColumn" text="Time" prefWidth="100"/>
                <TableColumn fx:id="tokenColumn" text="Token" prefWidth="80"/>
                <TableColumn fx:id="amountColumn" text="Amount" prefWidth="150"/>
                <TableColumn fx:id="valueColumn" text="Value (USD)" prefWidth="130"/>
                <TableColumn fx:id="typeColumn" text="Type" prefWidth="100"/>
                <TableColumn fx:id="fromColumn" text="From" prefWidth="150"/>
            </columns>
        </TableView>
    </VBox>
    
    <!-- Stats Row -->
    <HBox spacing="15">
        <VBox styleClass="stat-card" HBox.hgrow="ALWAYS">
            <Label text="24H WHALE VOLUME" styleClass="stat-label"/>
            <Label fx:id="totalVolumeLabel" text="\$2.4B" styleClass="stat-value-large"/>
        </VBox>
        <VBox styleClass="stat-card" HBox.hgrow="ALWAYS">
            <Label text="LARGE TXS TODAY" styleClass="stat-label"/>
            <Label fx:id="txCountLabel" text="127" styleClass="stat-value"/>
        </VBox>
        <VBox styleClass="stat-card" HBox.hgrow="ALWAYS">
            <Label text="TOP MOVED TOKEN" styleClass="stat-label"/>
            <Label fx:id="topTokenLabel" text="BTC" styleClass="stat-value"/>
        </VBox>
        <VBox styleClass="stat-card" HBox.hgrow="ALWAYS">
            <Label text="MARKET SENTIMENT" styleClass="stat-label"/>
            <Label fx:id="sentimentLabel" text="Bullish" styleClass="stat-value positive"/>
        </VBox>
    </HBox>

    <VBox styleClass="section-card" spacing="15">
        <HBox alignment="CENTER_LEFT" spacing="10">
            <FontIcon iconLiteral="fas-chart-area" iconSize="20" styleClass="section-icon"/>
            <Label text="Portfolio Analysis" styleClass="section-title"/>
            <Pane HBox.hgrow="ALWAYS"/>
            <ComboBox fx:id="portfolioCombo" prefWidth="200" styleClass="portfolio-select"/>
        </HBox>
        <VBox spacing="10">
            <Label text="PROFIT VS LOSS DAYS" styleClass="stat-label"/>
            <HBox alignment="CENTER_LEFT" spacing="12">
                <Label fx:id="profitDaysLabel" text="—" styleClass="stat-value positive"/>
                <ProgressBar fx:id="profitLossBar" prefWidth="260" styleClass="analysis-meter"/>
                <Label fx:id="lossDaysLabel" text="—" styleClass="stat-value negative"/>
            </HBox>
            <Label fx:id="profitLossSummaryLabel" text="No portfolio data" styleClass="chart-subtitle"/>
        </VBox>
        <HBox spacing="15">
            <VBox styleClass="stat-card" HBox.hgrow="ALWAYS">
                <Label text="BEST DAY" styleClass="stat-label"/>
                <Label fx:id="bestDayLabel" text="—" styleClass="stat-value"/>
            </VBox>
            <VBox styleClass="stat-card" HBox.hgrow="ALWAYS">
                <Label text="WORST DAY" styleClass="stat-label"/>
                <Label fx:id="worstDayLabel" text="—" styleClass="stat-value"/>
            </VBox>
        </HBox>
    </VBox>
</VBox>
